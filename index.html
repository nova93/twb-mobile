<!DOCTYPE html>
<html>
<head>
	<title>The Whiteboard Mobile</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		img {
			
		}
	</style>
</head>
<body>
	<script type="text/javascript">
		const url = "https://yacdn.org/serve/http://the-whiteboard.com";
		const regex = /<br><img SRC=".*"><br>/gmi;
		const regex2 = /".*"/gmi;
		fetch(url).then(function(response) {
			if(response.ok) {
				return response.text();
			}
			throw new Error('Network response was not ok.');
		}).then(function(rawResponse) {
			let imgName = rawResponse.match(regex)[0].match(regex2)[0]; //there is probably a better way to do that
			imgName = imgName.substring(1, imgName.length - 1);
			loadBackground(imgName);

		}).catch(function(error) {
		  console.log('There has been a problem with your fetch operation: ', error.message);
		});

		const loadImage = url => {
		  	return new Promise( (resolve, reject) => {
			    const image = new Image();
			    image.src = url;
			    image.onload = () => {
		    		resolve(image.src);
		    	};
		    	image.onerror = () => {
		    		reject(new Error('Could not load image at ' + url));
		    	};
			});
		}
		const handleSuccess = resolvedValue => {
			const comic = new Image();
			comic.src = resolvedValue;
			document.body.appendChild(comic);
		}
		const handleFailure = rejectionReason => {
			console.log(rejectionReason);
		}
		const loadBackground = (url) => {
			const path = 'http://the-whiteboard.com/' + url;
			loadImage(path).then(handleSuccess, handleFailure);
		}
	</script>
</body>
</html>